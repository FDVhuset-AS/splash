var t=Object.defineProperty,s=Object.defineProperties,i=Object.getOwnPropertyDescriptors,e=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,h=(s,i,e)=>i in s?t(s,i,{t:!0,i:!0,writable:!0,value:e}):s[i]=e;function o(t){return document.querySelector(t)}const c=t=>document.createElement(t);function a(t,...s){t.classList.add(...s)}function u(t,s,i){t.setAttribute(s,i)}class l{static h(t){if("string"==typeof t){const s=o(t);if(!s)throw new Error(`No match with ${t}`);return s}if(t instanceof Node)return t;throw new Error("Destination argument must string or Node")}static o(t){const o={getId:()=>t.getId(),remove:()=>t.delete(),moveTo:s=>t.moveTo(s),getText:()=>t.getText(),setText:s=>t.setText(s),getImgSrc:()=>t.getImgSrc(),setImgSrc:s=>t.setImgSrc(s)};return c=((t,s)=>{for(var i in s||(s={}))n.call(s,i)&&h(t,i,s[i]);if(e)for(var i of e(s))r.call(s,i)&&h(t,i,s[i]);return t})({},o),s(c,i({inside:s=>(t.moveTo(s),o)}));var c}static u(){const t=c("div");return a(t,"ns-spinner"),t.innerHTML='\n            <svg viewBox="0 0 50 50">\n                <circle class="path" cx="25" cy="25" r="20" fill="none"></circle>\n            </svg>\n        ',t}}class SplashInstance{constructor(t,s,i){var e;this.l=c("div"),this.m=c("div"),this.g=c("div"),this.v=l.u(),this.p=c("div"),this.S=c("div"),this.I=c("div"),this.F=c("img"),this.id=Math.random().toString(36).substring(2),this.N=t,this.m.innerText=s,this.O=i,this.F.src=null!=(e=this.O)?e:"",this.F.alt=Nanosplash.A,this.l.style.fontSize=t.getFontSize(),this.v.style.display=t.spinnerIsVisible()?"flex":"none",this.j(),this.setImgSrc(i)}T(){a(this.I,"ns-container"),a(this.S,"ns-blur"),a(this.F,"ns-img"),a(this.m,"ns-text"),a(this.g,"ns-text-container"),a(this.v,"ns-spinner"),a(this.p,"ns","ns-window"),a(this.l,"ns-wrapper")}D(){this.g.append(this.m,this.v),this.I.append(this.F,this.g),this.p.append(this.I),this.l.append(this.S,this.p)}j(){this.l.id=this.getId(),u(this.l,"data-ctx","nanosplash"),this.D(),this.T()}getId(){return this.id}getText(){return this.m.innerText}setText(t){return this.m.innerText=t,this}getImgSrc(){return this.O}setImgSrc(t){return this.F.src=null!=t?t:"",this.F.style.display=t?"block":"none",this.D(),this}getDestination(){return this.C}M(){const t=this.l.parentElement;t&&this.W(t)}k(){u(this.l,"style",""),this.l.classList.remove("ns-fs")}R(t){const s=t.parentNode;s&&(this.W(s),s.replaceChild(this.l,t),this.S.appendChild(t))}B(){this.l.classList.add("ns-fs"),((t,s,i=!1)=>{t&&s&&(s.hasChildNodes()&&i?s.insertBefore(t,s.firstChild):s.appendChild(t))})(this.l,document.body,!0)}H(t){this.N.getFromDestinationNode(t).filter((t=>t.getId()!==this.getId())).forEach((t=>t.delete()))}moveTo(t){this.M(),this.C=l.h(t),this.H(this.C),this.C===document.body?this.B():(this.k(),this.R(this.C)),this.j()}P(t){Array.from(this.S.childNodes).forEach(t)}W(t){this.P((s=>t.insertBefore(s,this.l)))}V(){[this.m,this.v,this.g,this.F,this.I,this.S,this.p,this.l].forEach((t=>t.remove()))}delete(){this.M(),this.V(),this.N.delete(this)}}class d{static $(t,s,i,e){var n;return t||(t=new SplashInstance(s,i,e)),t.setText(i).setImgSrc(null!=(n=t.getImgSrc())?n:e)}static q(t,s){return i=>(s=d.$(s,t,i),t.G.set(s.getId(),s),s.moveTo(document.body),l.o(s))}static J(t,s){return(...i)=>((s=d.$(s,t,"")).moveTo(document.body),(async()=>{for(const[t,[e,n]]of i.entries())s.setText(n),await e;s.delete()})(),l.o(s))}static K(t,s){return i=>(s=d.$(s,t,""),{show:e=>(t.G.set(s.getId(),s),s.moveTo(document.body),s.setText(e),i.finally((()=>s.delete())),l.o(s))})}}const m=class{constructor(t){var s;this.O=null==t?void 0:t.O,this.L=void 0===(null==t?void 0:t.L)?m.U:t.L,this.fontSize=null!=(s=null==t?void 0:t.fontSize)?s:"18px",this.G=new Map}setImgSrc(t){return this.O=t,this}showSpinner(t){return this.L=t,this}setFontSize(t){return this.fontSize=t,this}getImgSrc(){return this.O}spinnerIsVisible(){return this.L}getFontSize(){return this.fontSize}show(t){return d.q(this,new SplashInstance(this,t,this.O))(t)}progress(...t){return d.J(this,new SplashInstance(this,"",this.O))(...t)}while(t){return d.K(this,new SplashInstance(this,"",this.O))(t)}X(t){const s=this.G.size,i=Array.from(this.G.values());for(let e=s-1;e>=0;e--){const s=i[e];if(!t(s.getId(),s,e))break}}delete(t){this.G.delete(t.getId())}hideAll(){this.G.forEach((t=>t.delete()))}hide(t){if(t){const s=this.G.get(t);s?s.delete():Array.from(this.G.values()).filter((s=>s.getDestination()===o(t))).forEach((t=>t.delete()))}else{const t=this.G.size;this.X(((s,i,e)=>{const n=e===t-1;return n&&i.delete(),n}))}}getFromDestinationNode(t){return Array.from(this.G.values()).filter((s=>s.getDestination()===t))}};let Nanosplash=m;Nanosplash.A="Nanosplash",Nanosplash.U=!0,module.exports=Nanosplash;
