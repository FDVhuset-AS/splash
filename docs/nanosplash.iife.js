var I=Object.defineProperty,v=Object.defineProperties;var b=Object.getOwnPropertyDescriptors;var p=Object.getOwnPropertySymbols;var T=Object.prototype.hasOwnProperty,N=Object.prototype.propertyIsEnumerable;var S=(l,o,a)=>o in l?I(l,o,{enumerable:!0,configurable:!0,writable:!0,value:a}):l[o]=a,w=(l,o)=>{for(var a in o||(o={}))T.call(o,a)&&S(l,a,o[a]);if(p)for(var a of p(o))N.call(o,a)&&S(l,a,o[a]);return l},y=(l,o)=>v(l,b(o));(function(){"use strict";const l=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const c of i.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function t(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerpolicy&&(i.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?i.credentials="include":n.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(n){if(n.ep)return;n.ep=!0;const i=t(n);fetch(n.href,i)}};var o=(()=>`.ns-blur,body .ns-fs~*{filter:blur(5px);overflow:hidden}.ns-wrapper{position:relative}.ns-fs{left:0;min-height:100vh;min-width:100%;position:fixed;top:0;z-index:2}.ns-window{align-items:center;background-color:#fffc;display:flex;height:100%;justify-content:center;left:0;position:absolute;top:0;width:100%;z-index:1}.ns-img{margin-bottom:2em;max-height:9rem;width:9rem}.ns-text-container{align-items:center}.ns-text,.ns-text-container{display:flex;justify-content:center}.ns-text{color:#5a6685}.ns-spinner{display:flex;height:1em;margin-left:1em;width:1em}.ns-spinner>svg{stroke-width:8;-webkit-animation:Rotate 2s linear infinite;animation:Rotate 2s linear infinite;height:inherit;position:relative;width:inherit}.ns-spinner .path{stroke:#5a6685;stroke-linecap:round;-webkit-animation:Dash 1.5s ease-in-out infinite;animation:Dash 1.5s ease-in-out infinite}@-webkit-keyframes Rotate{to{transform:rotate(1turn)}}@keyframes Rotate{to{transform:rotate(1turn)}}@-webkit-keyframes Dash{0%{stroke-dasharray:1,150;stroke-dashoffset:0}50%{stroke-dasharray:90,150;stroke-dashoffset:-35}to{stroke-dasharray:90,150;stroke-dashoffset:-124}}@keyframes Dash{0%{stroke-dasharray:1,150;stroke-dashoffset:0}50%{stroke-dasharray:90,150;stroke-dashoffset:-35}to{stroke-dasharray:90,150;stroke-dashoffset:-124}}
`)();function a(r){return document.querySelector(r)}function x(r,e,t=!1){r&&e&&(e.hasChildNodes()&&t?e.insertBefore(r,e.firstChild):e.appendChild(r))}const m=r=>document.createElement(r);function h(r,...e){r.classList.add(...e)}function E(r,e,t){r.setAttribute(e,t)}class u{static destinationToNode(e){if(typeof e=="string"){const t=a(e);if(!t)throw new Error(`No match with ${e}`);return t}else if(e instanceof Node)return e;throw new Error("Destination argument must string or Node")}static createContextualApiObject(e){const t={getId:()=>e.getId(),remove:()=>e.delete(),moveTo:s=>e.moveTo(s),getText:()=>e.getText(),setText:s=>e.setText(s),getImgSrc:()=>e.getImgSrc(),setImgSrc:s=>e.setImgSrc(s)};return y(w({},t),{inside:s=>(e.moveTo(s),t)})}static createNanosplashSpinnerElement(){const e=m("div");return h(e,"ns-spinner"),e.innerHTML=`
            <svg viewBox="0 0 50 50">
                <circle class="path" cx="25" cy="25" r="20" fill="none"></circle>
            </svg>
        `,e}}class f{constructor(e,t,s){var n;this.nsRootElement=m("div"),this.nsTextElement=m("div"),this.nsTextContainerElement=m("div"),this.nsSpinnerElement=u.createNanosplashSpinnerElement(),this.nsWindowElement=m("div"),this.nsWrapperElement=m("div"),this.nsContentElement=m("div"),this.nsImageElement=m("img"),this.id=Math.random().toString(36).substring(2),this.nsInstance=e,this.nsTextElement.innerText=t,this.imgSrc=s,this.nsImageElement.src=(n=this.imgSrc)!=null?n:"",this.nsImageElement.alt=g.APP_NAME,this.nsRootElement.style.fontSize=e.fontSize,this.nsSpinnerElement.style.display=e.showSpinner?"flex":"none",this.assembleNSComponent(),this.setImgSrc(s)}assignCSSClasses(){h(this.nsContentElement,"ns-container"),h(this.nsWrapperElement,"ns-blur"),h(this.nsImageElement,"ns-img"),h(this.nsTextElement,"ns-text"),h(this.nsTextContainerElement,"ns-text-container"),h(this.nsSpinnerElement,"ns-spinner"),h(this.nsWindowElement,"ns","ns-window"),h(this.nsRootElement,"ns-wrapper")}assembleElementStructure(){this.nsTextContainerElement.append(this.nsTextElement,this.nsSpinnerElement),this.nsContentElement.append(this.nsImageElement,this.nsTextContainerElement),this.nsWindowElement.append(this.nsContentElement),this.nsRootElement.append(this.nsWrapperElement,this.nsWindowElement)}assembleNSComponent(){this.nsRootElement.id=this.getId(),E(this.nsRootElement,"data-ctx","nanosplash"),this.assembleElementStructure(),this.assignCSSClasses()}getId(){return this.id}getText(){return this.nsTextElement.innerText}setText(e){return this.nsTextElement.innerText=e,this}getImgSrc(){return this.imgSrc}setImgSrc(e){return this.nsImageElement.src=e!=null?e:"",this.nsImageElement.style.display=e?"block":"none",this.assembleElementStructure(),this}getDestination(){return this.destinationNode}cleanAndRestore(){const e=this.nsRootElement.parentElement;e&&this.restoreDOMStructure(e)}resetFullscreenAttributes(){E(this.nsRootElement,"style",""),this.nsRootElement.classList.remove("ns-fs")}moveWithRegularStrategy(e){const t=e.parentNode;t&&(this.restoreDOMStructure(t),t.replaceChild(this.nsRootElement,e),this.nsWrapperElement.appendChild(e))}moveWithFullscreenStrategy(){this.nsRootElement.classList.add("ns-fs"),x(this.nsRootElement,document.body,!0)}replaceSplashInstancesHavingSameDestination(e){const t=n=>n.getId()!==this.getId(),s=n=>n.delete();this.nsInstance.getSplashesWithDestinationNode(e).filter(t).forEach(s)}moveTo(e){this.cleanAndRestore(),this.destinationNode=u.destinationToNode(e),this.replaceSplashInstancesHavingSameDestination(this.destinationNode),this.destinationNode===document.body?this.moveWithFullscreenStrategy():(this.resetFullscreenAttributes(),this.moveWithRegularStrategy(this.destinationNode)),this.assembleNSComponent()}forEachWrappedNode(e){Array.from(this.nsWrapperElement.childNodes).forEach(e)}restoreDOMStructure(e){this.forEachWrappedNode(t=>e.insertBefore(t,this.nsRootElement))}removeElementsFromDOM(){[this.nsTextElement,this.nsSpinnerElement,this.nsTextContainerElement,this.nsImageElement,this.nsContentElement,this.nsWrapperElement,this.nsWindowElement,this.nsRootElement].forEach(e=>e.remove())}delete(){this.cleanAndRestore(),this.removeElementsFromDOM(),this.nsInstance.delete(this)}}class d{static ensureInstance(e,t,s,n){var i;return e||(e=new f(t,s,n)),e.setText(s).setImgSrc((i=e.getImgSrc())!=null?i:n)}static createShowFunction(e,t){return s=>(t=d.ensureInstance(t,e,s),e.instances.set(t.getId(),t),t.moveTo(document.body),u.createContextualApiObject(t))}static createProgressFunction(e,t){return(...s)=>(t=d.ensureInstance(t,e,""),t.moveTo(document.body),(async()=>{for(const[n,[i,c]]of s.entries())t.setText(c),await i;t.delete()})(),u.createContextualApiObject(t))}static createWhileFunction(e,t){return s=>(t=d.ensureInstance(t,e,""),{show(n){return e.instances.set(t.getId(),t),t.moveTo(document.body),t.setText(n),s.finally(()=>t.delete()),u.createContextualApiObject(t)}})}}class g{constructor(e){var t,s,n;this.imgSrc=(t=e==null?void 0:e.imgSrc)!=null?t:void 0,this.showSpinner=(s=e==null?void 0:e.spinner)!=null?s:!1,this.fontSize=(n=e==null?void 0:e.fontSize)!=null?n:"18px",this.instances=new Map}show(e){return d.createShowFunction(this,new f(this,e,this.imgSrc))(e)}progress(...e){return d.createProgressFunction(this,new f(this,"",this.imgSrc))(...e)}while(e){return d.createWhileFunction(this,new f(this,"",this.imgSrc))(e)}lifoIterate(e){const t=this.instances.size,s=Array.from(this.instances.values());for(let n=t-1;n>=0;n--){console.log({size:t,lastIdx:t-1,currentIdx:n});const i=s[n],c=i.getId();if(!e(c,i,n))break}}delete(e){this.instances.delete(e.getId())}hideAll(){this.instances.forEach(e=>e.delete())}hide(e){if(e){const t=this.instances.get(e);if(t)t.delete();else throw new Error(`Could not find element with id: ${e}`)}else{const t=this.instances.size;this.lifoIterate((s,n,i)=>{const c=i===t-1;return c&&n.delete(),c})}}getSplashesWithDestinationNode(e){const t=s=>s.getDestination()===e;return Array.from(this.instances.values()).filter(t)}}g.APP_NAME="Nanosplash",window.addEventListener("load",()=>{window.Nanosplash=g,window.installNanosplash=r=>{window.ns=new g(r)}})})();
