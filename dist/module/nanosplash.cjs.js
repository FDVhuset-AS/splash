var t=Object.defineProperty,s=Object.defineProperties,i=Object.getOwnPropertyDescriptors,e=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,h=Object.prototype.propertyIsEnumerable,r=(s,i,e)=>i in s?t(s,i,{t:!0,i:!0,writable:!0,value:e}):s[i]=e;function o(t){return document.querySelector(t)}const a=t=>document.createElement(t);function c(t,...s){t.classList.add(...s)}function l(t,s,i){t.setAttribute(s,i)}class NanosplashRepository{static h(t){if("string"==typeof t){const s=o(t);if(!s)throw new Error(`No match with ${t}`);return s}if(t instanceof Node)return t;throw new Error("Destination argument must string or Node")}static o(t){const o={getId:()=>t.getId(),remove:()=>t.delete(),moveTo:s=>t.moveTo(s),getText:()=>t.getText(),setText:s=>t.setText(s),getImgSrc:()=>t.getImgSrc(),setImgSrc:s=>t.setImgSrc(s)};return a=((t,s)=>{for(var i in s||(s={}))n.call(s,i)&&r(t,i,s[i]);if(e)for(var i of e(s))h.call(s,i)&&r(t,i,s[i]);return t})({},o),s(a,i({inside:s=>(t.moveTo(s),o)}));var a}static l(){const t=a("div");return c(t,"ns-spinner"),t.innerHTML='\n            <svg viewBox="0 0 50 50">\n                <circle class="path" cx="25" cy="25" r="20" fill="none"></circle>\n            </svg>\n        ',t}}class SplashInstance{constructor(t,s,i){var e;this.u=a("div"),this.p=a("div"),this.m=a("div"),this.g=NanosplashRepository.l(),this.v=a("div"),this.S=a("div"),this.N=a("div"),this.I=a("img"),this.id=Math.random().toString(36).substring(2),this.F=t,this.p.innerText=s,this.O=i,this.I.src=null!=(e=this.O)?e:"",this.I.alt=p.A,this.u.style.fontSize=t.getFontSize(),this.g.style.display=t.spinnerIsVisible()?"flex":"none",this.R(),this.setImgSrc(i)}j(){c(this.N,"ns-container"),c(this.S,"ns-blur"),c(this.I,"ns-img"),c(this.p,"ns-text"),c(this.m,"ns-text-container"),c(this.g,"ns-spinner"),c(this.v,"ns","ns-window"),c(this.u,"ns-wrapper")}T(){this.m.append(this.p,this.g),this.N.append(this.I,this.m),this.v.append(this.N),this.u.append(this.S,this.v)}R(){this.u.id=this.getId(),l(this.u,"data-ctx","nanosplash"),this.T(),this.j()}getId(){return this.id}getText(){return this.p.innerText}setText(t){return this.p.innerText=t,this}getImgSrc(){return this.O}setImgSrc(t){return this.I.src=null!=t?t:"",this.I.style.display=t?"block":"none",this.T(),this}getDestination(){return this.D}C(){const t=this.u.parentElement;t&&this.M(t)}W(){l(this.u,"style",""),this.u.classList.remove("ns-fs")}k(t){const s=t.parentNode;s&&(this.M(s),s.replaceChild(this.u,t),this.S.appendChild(t))}B(){this.u.classList.add("ns-fs"),((t,s,i=!1)=>{t&&s&&(s.hasChildNodes()&&i?s.insertBefore(t,s.firstChild):s.appendChild(t))})(this.u,document.body,!0)}H(t){this.F.getFromDestinationNode(t).filter((t=>t.getId()!==this.getId())).forEach((t=>t.delete()))}moveTo(t){this.C(),this.D=NanosplashRepository.h(t),this.H(this.D),this.D===document.body?this.B():(this.W(),this.k(this.D)),this.R()}P(t){Array.from(this.S.childNodes).forEach(t)}M(t){this.P((s=>t.insertBefore(s,this.u)))}V(){[this.p,this.g,this.m,this.I,this.N,this.S,this.v,this.u].forEach((t=>t.remove()))}delete(){this.C(),this.V(),this.F.delete(this)}}class NanosplashFactory{static $(t,s,i,e){var n;return t||(t=new SplashInstance(s,i,e)),t.setText(i).setImgSrc(null!=(n=t.getImgSrc())?n:e)}static q(t,s){return i=>(s=NanosplashFactory.$(s,t,i),t.G.set(s.getId(),s),s.moveTo(document.body),NanosplashRepository.o(s))}static J(t,s){return(...i)=>((s=NanosplashFactory.$(s,t,"")).moveTo(document.body),(async()=>{for(const[t,[e,n]]of i.entries())s.setText(n),await e;s.delete()})(),NanosplashRepository.o(s))}static K(t,s){return i=>(s=NanosplashFactory.$(s,t,""),{show:e=>(t.G.set(s.getId(),s),s.moveTo(document.body),s.setText(e),i.finally((()=>s.delete())),NanosplashRepository.o(s))})}}const u=class{constructor(t){var s;this.O=null==t?void 0:t.O,this.L=void 0===(null==t?void 0:t.L)?u.U:t.L,this.fontSize=null!=(s=null==t?void 0:t.fontSize)?s:"18px",this.G=new Map}setImgSrc(t){return this.O=t,this}showSpinner(t){return this.L=t,this}setFontSize(t){return this.fontSize=t,this}getImgSrc(){return this.O}spinnerIsVisible(){return this.L}getFontSize(){return this.fontSize}show(t){return NanosplashFactory.q(this,new SplashInstance(this,t,this.O))(t)}progress(...t){return NanosplashFactory.J(this,new SplashInstance(this,"",this.O))(...t)}while(t){return NanosplashFactory.K(this,new SplashInstance(this,"",this.O))(t)}X(t){const s=this.G.size,i=Array.from(this.G.values());for(let e=s-1;e>=0;e--){const s=i[e];if(!t(s.getId(),s,e))break}}delete(t){this.G.delete(t.getId())}hideAll(){this.G.forEach((t=>t.delete()))}hide(t){if(t){const s=this.G.get(t);s?s.delete():Array.from(this.G.values()).filter((s=>s.getDestination()===o(t))).forEach((t=>t.delete()))}else{const t=this.G.size;this.X(((s,i,e)=>{const n=e===t-1;return n&&i.delete(),n}))}}getFromDestinationNode(t){return Array.from(this.G.values()).filter((s=>s.getDestination()===t))}};let p=u;p.A="Nanosplash",p.U=!0,module.exports=p;
