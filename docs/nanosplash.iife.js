var v=Object.defineProperty,b=Object.defineProperties;var x=Object.getOwnPropertyDescriptors;var I=Object.getOwnPropertySymbols;var y=Object.prototype.hasOwnProperty,C=Object.prototype.propertyIsEnumerable;var w=(l,o,c)=>o in l?v(l,o,{enumerable:!0,configurable:!0,writable:!0,value:c}):l[o]=c,S=(l,o)=>{for(var c in o||(o={}))y.call(o,c)&&w(l,c,o[c]);if(I)for(var c of I(o))C.call(o,c)&&w(l,c,o[c]);return l},p=(l,o)=>b(l,x(o));(function(){"use strict";const l=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const h of r.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&n(h)}).observe(document,{childList:!0,subtree:!0});function t(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerpolicy&&(r.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?r.credentials="include":s.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(s){if(s.ep)return;s.ep=!0;const r=t(s);fetch(s.href,r)}};var o="";function c(i){return document.querySelector(i)}function T(i,e,t=!1){i&&e&&(e.hasChildNodes()&&t?e.insertBefore(i,e.firstChild):e.appendChild(i))}const u=i=>document.createElement(i);function a(i,...e){i.classList.add(...e)}function E(i,e,t){i.setAttribute(e,t)}class f{static destinationToNode(e){if(typeof e=="string"){const t=c(e);if(!t)throw new Error(`No match with ${e}`);return t}else if(e instanceof Node)return e;throw new Error("Destination argument must string or Node")}static createContextualApiObject(e){const t={getId:()=>e.getId(),remove:()=>e.delete(),moveTo:n=>e.moveTo(n),getText:()=>e.getText(),setText:n=>e.setText(n),getImgSrc:()=>e.getImgSrc(),setImgSrc:n=>e.setImgSrc(n)};return p(S({},t),{inside:n=>(e.moveTo(n),t)})}}class d{constructor(e,t,n){var s;this.nsRootElement=u("div"),this.nsWrapperElement=u("div"),this.nsWindowElement=u("div"),this.nsContentElement=u("div"),this.nsImageElement=u("img"),this.nsTextElement=u("div"),this.id=Math.random().toString(36).substring(2),this.nsInstance=e,this.nsTextElement.innerText=t,this.imgSrc=n,this.nsImageElement.src=(s=this.imgSrc)!=null?s:"",this.nsImageElement.alt=g.APP_NAME,this.assembleNSComponent(),this.setImgSrc(n)}assignCSSClasses(){a(this.nsContentElement,"ns-container"),a(this.nsWrapperElement,"ns-blur"),a(this.nsImageElement,"ns-img"),a(this.nsTextElement,"ns-text"),a(this.nsWindowElement,"ns","ns-window"),a(this.nsRootElement,"ns-wrapper")}assembleElementStructure(){this.nsContentElement.append(this.nsImageElement,this.nsTextElement),this.nsWindowElement.append(this.nsContentElement),this.nsRootElement.append(this.nsWrapperElement,this.nsWindowElement)}assembleNSComponent(){this.nsRootElement.id=this.getId(),E(this.nsRootElement,"data-ctx","nanosplash"),this.assembleElementStructure(),this.assignCSSClasses()}getId(){return this.id}getText(){return this.nsTextElement.innerText}setText(e){return this.nsTextElement.innerText=e,this}getImgSrc(){return this.imgSrc}setImgSrc(e){return this.nsImageElement.src=e!=null?e:"",this.nsImageElement.style.display=e?"block":"none",this.assembleElementStructure(),this}cleanup(){const e=this.nsRootElement.parentElement;e&&this.restoreDOMStructure(e)}resetFullscreenAttributes(){E(this.nsRootElement,"style",""),this.nsRootElement.classList.remove("ns-fs")}moveWithRegularStrategy(e){const t=e.parentNode;t&&(this.restoreDOMStructure(t),t.replaceChild(this.nsRootElement,e),this.nsWrapperElement.appendChild(e))}moveWithFullscreenStrategy(){this.nsRootElement.classList.add("ns-fs"),T(this.nsRootElement,document.body,!0)}moveTo(e){this.cleanup();const t=f.destinationToNode(e);t===document.body?this.moveWithFullscreenStrategy():(this.resetFullscreenAttributes(),this.moveWithRegularStrategy(t)),this.assembleNSComponent()}forEachWrappedNode(e){Array.from(this.nsWrapperElement.childNodes).forEach(e)}restoreDOMStructure(e){this.forEachWrappedNode(t=>e.insertBefore(t,this.nsRootElement))}removeElementsFromDOM(){[this.nsTextElement,this.nsImageElement,this.nsContentElement,this.nsWrapperElement,this.nsWindowElement,this.nsRootElement].forEach(e=>e.remove())}delete(){this.cleanup(),this.removeElementsFromDOM(),this.nsInstance.delete(this)}}class m{static ensureInstance(e,t,n,s){var r;return e||(e=new d(t,n,s)),e.setText(n).setImgSrc((r=e.getImgSrc())!=null?r:s)}static createImgFunction(e,t){return n=>(t=m.ensureInstance(t,e,"",n),{show:m.createShowFunction(e,t),progress:m.createProgressFunction(e,t),while:m.createWhileFunction(e,t)})}static createShowFunction(e,t){return n=>(t=m.ensureInstance(t,e,n),e.instances.set(t.getId(),t),t.moveTo(document.body),f.createContextualApiObject(t))}static createProgressFunction(e,t){return(...n)=>(t=m.ensureInstance(t,e,""),t.moveTo(document.body),(async()=>{for(const[s,[r,h]]of n.entries())t.setText(h),await r;t.delete()})(),f.createContextualApiObject(t))}static createWhileFunction(e,t){return n=>(t=m.ensureInstance(t,e,""),{show(s){return e.instances.set(t.getId(),t),t.moveTo(document.body),t.setText(s),n.finally(()=>t.delete()),f.createContextualApiObject(t)}})}}class g{constructor(){this.instances=new Map}img(e){return m.createImgFunction(this,new d(this,"",e))(e)}show(e){return m.createShowFunction(this,new d(this,e))(e)}progress(...e){return m.createProgressFunction(this,new d(this,""))(...e)}while(e){return m.createWhileFunction(this,new d(this,""))(e)}fifoIterate(e){let t=0;const n=this.instances.entries();for(const[s,r]of n)if(!e(s,r,t++))break}delete(e){this.instances.delete(e.getId())}hideAll(){this.instances.forEach(e=>e.delete())}hide(e){if(e){const t=this.instances.get(e);if(t)t.delete();else throw new Error(`Could not find element with id: ${e}`)}else this.fifoIterate((t,n,s)=>{const r=s===0;return r&&n.delete(),r})}}g.APP_NAME="Nanosplash",window.addEventListener("load",()=>window.ns=new g)})();
